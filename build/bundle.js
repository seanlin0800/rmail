webpackJsonp([0],{0:function(t,e,n){"use strict";var i=n(1),a=n(152),s=n(215),r=n(483);n(484),n(493),n(495),r.init(),s.getBoxData(),s.auth(JSON.parse(sessionStorage.getItem("user"))),a.run(function(t){i.render(i.createElement(t),document.getElementById("app"))})},152:function(t,e,n){"use strict";var i,a,s;t.exports={makePath:function(t,e,n){return s.makePath(t,e,n)},makeHref:function(t,e,n){return s.makeHref(t,e,n)},transitionTo:function(t,e,n){s.transitionTo(t,e,n)},replaceWith:function(t,e,n){s.replaceWith(t,e,n)},goBack:function(){s.goBack()},run:function(t){s.run(t)}},i=n(153),a=n(192),s=i.create({routes:a,location:i.HashLocation})},192:function(t,e,n){"use strict";var i=n(1),a=n(153),s=a.Route,r=a.DefaultRoute,o=n(469),c=n(475),l=n(193),u=n(476),m=n(481),d=n(482),h=i.createElement(s,{name:"app",path:"/",handler:o},i.createElement(s,{name:"login",path:"/login",handler:c}),i.createElement(s,{name:"main",path:"/mail",handler:l},i.createElement(s,{name:"mailboxes",path:"/mail/:name",handler:u}),i.createElement(s,{name:"mails",path:"/mail/:name/:id",handler:m}),i.createElement(r,{handler:d.create("box")})),i.createElement(r,{handler:c}));t.exports=h},193:function(t,e,n){"use strict";var i=n(1),a=n(194),s=n(208),r=n(210),o=n(221),c=n(231),l=n(322),u=n(323),m=n(467),d=i.createClass({displayName:"Main",statics:{willTransitionTo:function(t){m.isLoggedIn()||t.redirect("/login",{},{nextPath:t.path})}},_handleClick:function(){s.isMenuActive()&&a.hideMenu()},render:function(){return i.createElement("div",{className:"main",onClick:this._handleClick},i.createElement(u,null),i.createElement("div",{className:"container"},i.createElement("div",{className:"row"},i.createElement(c,null),i.createElement(l,null))),i.createElement(r,null),i.createElement(o,null))}});t.exports=d},194:function(t,e,n){"use strict";function i(){this.generateActions("showMenu","hideMenu")}var a=n(195);t.exports=a.createActions(i)},195:function(t,e,n){"use strict";var i=n(196),a=new i;t.exports=a},208:function(t,e,n){"use strict";function i(){this.bindActions(r),this.isActive=!1,this.menuState={xPos:0,yPos:0,id:-1},this.exportPublicMethods({isMenuActive:function(){return this.getState().isActive},getMenuState:function(){return this.getState().menuState}})}var a=n(195),s=n(209),r=n(194);i.prototype.onShowMenu=function(t){this.isActive=!0,s(this.menuState,t)},i.prototype.onHideMenu=function(){this.isActive=!1},t.exports=a.createStore(i,"ContextMenuStore")},210:function(t,e,n){"use strict";var i=n(1),a=n(211),s=n(213),r=n(217),o=i.createClass({displayName:"NewMsgBox",mixins:[a],getInitialState:function(){return this._getStateFromStores()},componentDidMount:function(){this.listenTo(s,this._onChange)},_renderBoxList:function(){var t=this.state.boxKeyList,e=t.length-2;return t.map(function(t,n){return i.createElement(r,{key:t,id:t,isHidden:e>n})})},_getStateFromStores:function(){return{boxKeyList:s.getNewMsgKeys()}},_onChange:function(){this.setState(this._getStateFromStores())},render:function(){return i.createElement("div",{className:"new-message"},this._renderBoxList())}});t.exports=o},211:function(t,e,n){"use strict";var i=n(212),a={componentWillMount:function(){i.create(this)},componentWillUnmount:function(){i.destroy(this)},listenTo:function(t,e){i.add(this,t,e)},listenToMany:function(t,e){t.forEach(function(t){this.listenTo(t,e)},this)},getListeners:function(){return i.listeners(this)}};t.exports=a},212:function(t,e){"use strict";var n={create:function(t){t._AltMixinRegistry=t._AltMixinRegistry||[]},add:function(t,e,n){t._AltMixinRegistry.push(e.listen(n))},destroy:function(t){t._AltMixinRegistry.forEach(function(t){t()}),t._AltMixinRegistry=[]},listeners:function(t){return t._AltMixinRegistry}};t.exports=n},213:function(t,e,n){"use strict";function i(){this.bindActions(s),this.newMsgBoxes={},this.newMsgBoxId=0,this.exportPublicMethods({getNewMsgKeys:function(){return Object.keys(this.getState().newMsgBoxes)}})}var a=n(195),s=n(214);i.prototype.onAddNewMsgBox=function(){this.newMsgBoxes[this.newMsgBoxId++]=1},i.prototype.onDelNewMsgBox=function(t){delete this.newMsgBoxes[t]},t.exports=a.createStore(i,"MsgBoxStore")},214:function(t,e,n){"use strict";function i(){this.generateActions("addNewMsgBox","delNewMsgBox"),this.sendMail=function(t){t.date=(new Date).toISOString(),this.dispatch(),s.sendMail(t)}}var a=n(195),s=n(215);t.exports=a.createActions(i)},215:function(t,e,n){"use strict";function i(){return JSON.parse(sessionStorage.getItem("mails"))}function a(t){sessionStorage.setItem("mails",JSON.stringify(t))}function s(t,e){var n,i=t.length;for(n=0;i>n;n++)if(e===t[n].name)return t[n];return{}}function r(t){var e=i(),n=s(e,"sent"),r=0;return n.emails.length>0&&(r=n.emails.slice(-1)[0].id+1),t.id=r,n.emails.push(t),a(e),r}function o(t){var e=Math.random().toString(36).substring(7),n={};return n[t]=e,sessionStorage.setItem("server_user",JSON.stringify(n)),e}function c(t){var e=JSON.parse(sessionStorage.getItem("server_user"));return e&&e[t.user]===t.token?!0:!1}function l(t){var e=JSON.parse(sessionStorage.getItem("server_user"));delete e[t],sessionStorage.setItem("server_user",JSON.stringify(e))}var u=n(209),m=n(216),d=n(152);t.exports={getBoxData:function(){var t=i();m.receiveAll(t)},getEmail:function(t,e,n){var i,a=s(t,e),r=a.emails.length;for(i=0;r>i;i++)if(n===a.emails[i].id)return a.emails[i];return{}},updateMail:function(t,e,n){var s=i(),r=this.getEmail(s,t,e);u(r,n),a(s)},deleteEmail:function(t,e){var n,r=i(),o=s(r,t),c=o.emails.length;for(n=0;c>n;n++)if(e===o.emails[n].id)return o.emails.splice(n,1),void a(r)},auth:function(t){return m.auth(),t&&c(t)?void setTimeout(function(){m.authSuccess(t)},500):void setTimeout(function(){m.authError(t)},500)},sendMail:function(t){t.id=r(u({},t)),setTimeout(function(){m.sendMailSuccess(t)},500)},login:function(t){var e;"seanlin0800@rmail.com"===t.email&&"pass"===t.password?(e=o(t.email),setTimeout(function(){m.loginSuccess({name:"seanlin0800@rmail.com",token:e})},500)):setTimeout(function(){m.loginError()},500)},logout:function(t){l(t),setTimeout(function(){d.transitionTo("login")},500)}}},216:function(t,e,n){"use strict";function i(){this.generateActions("receiveAll","sendMailSuccess","loginSuccess","loginError","auth","authSuccess","authError")}var a=n(195);t.exports=a.createActions(i)},217:function(t,e,n){"use strict";var i=n(1),a=n(218),s=n(214),r=n(219),o="New Message",c=i.createClass({displayName:"Model",propTypes:{id:i.PropTypes.string,isHidden:i.PropTypes.bool},getInitialState:function(){return{title:o}},_handleClose:function(){s.delNewMsgBox(this.props.id)},_updateTitle:function(t){this.setState({title:t||o})},_send:function(){s.sendMail(this.refs.form.getInpuValues()),this._handleClose()},render:function(){var t=a({"modal-dialog":!0,box:!0,hidden:this.props.isHidden});return i.createElement("div",{className:t},i.createElement("div",{className:"modal-content"},i.createElement("div",{className:"modal-header"},i.createElement("button",{type:"button",className:"close",onClick:this._handleClose,"aria-label":"Close"},i.createElement("span",{"aria-hidden":"true"},"×")),i.createElement("h4",{className:"modal-title"},this.state.title)),i.createElement("div",{className:"modal-body"},i.createElement(r,{updateHandler:this._updateTitle,ref:"form"})),i.createElement("div",{className:"modal-footer"},i.createElement("button",{type:"button",className:"btn btn-primary",onClick:this._send},"Send"))))}});t.exports=c},219:function(t,e,n){"use strict";var i=n(1),a=n(220),s=i.createClass({displayName:"NewMsgForm",propTypes:{updateHandler:i.PropTypes.func},getInpuValues:function(){var t=i.findDOMNode(this.refs.recipient).value.trim(),e=i.findDOMNode(this.refs.subject).value.trim(),n=i.findDOMNode(this.refs.message).value.trim();return i.findDOMNode(this.refs.recipient).value="",i.findDOMNode(this.refs.subject).value="",i.findDOMNode(this.refs.message).value="",{from:a.USER,to:t,subject:e,body:n}},_update:function(t){this.props.updateHandler(t.target.value)},render:function(){return i.createElement("form",null,i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"recipient",className:"control-label"},"Recipient:"),i.createElement("input",{type:"text",className:"form-control",id:"recipient",ref:"recipient"})),i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"subject",className:"control-label"},"Subject:"),i.createElement("input",{type:"text",className:"form-control",id:"subject",ref:"subject",onBlur:this._update})),i.createElement("div",{className:"form-group"},i.createElement("label",{htmlFor:"message",className:"control-label"},"Message:"),i.createElement("textarea",{className:"form-control",id:"message",rows:"5",ref:"message"})))}});t.exports=s},220:function(t,e){"use strict";t.exports={TITLE:"Rmail",USER:"seanlin0800@rmail.com"}},221:function(t,e,n){"use strict";var i=n(1),a=n(211),s=n(222),r=n(228),o=i.createClass({displayName:"NotificationBox",mixins:[a],componentDidMount:function(){this.listenTo(r,this._onChange)},_onChange:function(){var t={message:r.getMessage(),position:"tc",level:"success",action:r.getAction()};this.refs.notificationSystem.addNotification(t)},render:function(){return i.createElement(s,{ref:"notificationSystem"})}});t.exports=o},228:function(t,e,n){"use strict";function i(){this.bindActions(r),this.message="",this.action={},this.exportPublicMethods({getMessage:function(){return this.getState().message},getAction:function(){return this.getState().action}})}var a=n(195),s=n(152),r=n(216),o=n(229);i.prototype.onSendMailSuccess=function(t){this.waitFor([o.dispatchToken]),this.message="Your message has been sent",this.action={label:"View message",callback:function(){s.transitionTo("mails",{name:"sent",id:t.id})}}},t.exports=a.createStore(i,"NotificationStore")},229:function(t,e,n){"use strict";function i(){this.bindActions(s),this.bindActions(r),this.mailData={},this.exportPublicMethods({getAll:function(){return this.getState().mailData},getBox:function(t){return this.getState().mailData[t]},get:function(t,e){return this.getState().mailData[t].emails[parseInt(e,10)]}})}var a=n(195),s=n(230),r=n(216);i.prototype.onReceiveAll=function(t){var e,n=null,i=t.length;for(e=0;i>e;e++)n=t[e],this.mailData[n.name]||(this.mailData[n.name]=this._convert(n))},i.prototype.onMarkThread=function(t){this._markThread(t)},i.prototype.onDelete=function(t){delete this.mailData[t.name].emails[t.id]},i.prototype.onClickStar=function(t){var e=this._get(this.mailData,t.name,t.id);e.isStarred=!t.val},i.prototype.onSendMailSuccess=function(t){this.mailData.sent.emails[t.id]=t},i.prototype._markThread=function(t){var e=this._get(this.mailData,t.name,t.id);e.isRead=t.val},i.prototype._convert=function(t){return{id:t.id,name:t.name,emails:this._toObj(t.emails)}},i.prototype._toObj=function(t){var e,n={},i=t.length;for(e=0;i>e;e++)n[t[e].id]=t[e];return n},i.prototype._get=function(t,e,n){return t[e].emails[n]},t.exports=a.createStore(i,"EmailStore")},230:function(t,e,n){"use strict";function i(){this.markThread=function(t,e,n){this.dispatch({name:t,id:e,val:n}),s.updateMail(t,parseInt(e,10),{isRead:n})},this["delete"]=function(t,e){this.dispatch({name:t,id:e}),s.deleteEmail(t,parseInt(e,10))},this.clickStar=function(t){s.updateMail(t.name,parseInt(t.id,10),{isStarred:!t.val}),this.dispatch(t)}}var a=n(195),s=n(215);t.exports=a.createActions(i)},231:function(t,e,n){"use strict";var i=n(1),a=n(214),s=n(232),r=i.createClass({displayName:"Sidebar",_clickCompose:function(){a.addNewMsgBox()},render:function(){return i.createElement("div",{className:"col-md-2 sidebar"},i.createElement("button",{type:"button",className:"btn btn-primary btn-block",onClick:this._clickCompose},"COMPOSE"),i.createElement(s,null))}});t.exports=r},232:function(t,e,n){"use strict";var i=n(1),a=n(211),s=n(233),r=n(234),o=i.createClass({displayName:"MailboxList",mixins:[a],getInitialState:function(){return this._getStateFromStores()},componentDidMount:function(){this.listenTo(s,this._onChange)},_getStateFromStores:function(){return{mailboxes:s.getAll()}},_onChange:function(){this.setState(this._getStateFromStores())},render:function(){var t=Object.keys(this.state.mailboxes).map(function(t){return i.createElement(r,{key:this.state.mailboxes[t].id,name:t,unreadCount:this.state.mailboxes[t].unreadCount})}.bind(this));return i.createElement("div",{className:"mailbox-list"},i.createElement("ul",{className:"list-group"},t))}});t.exports=o},233:function(t,e,n){"use strict";function i(){this.bindActions(s),this.bindActions(r),this.boxData={},this.exportPublicMethods({getAll:function(){return this.getState().boxData},get:function(t){return this.getState().boxData[t]}})}var a=n(195),s=n(230),r=n(216),o=n(229);i.prototype.onReceiveAll=function(){var t,e,n;this.waitFor([o.dispatchToken]),t=o.getAll();for(e in t)t.hasOwnProperty(e)&&(n=t[e],this.boxData[n.name]||(this.boxData[n.name]=this._convert(n)))},i.prototype.onMarkThread=function(t){this._updateCount(t.name)},i.prototype.onDelete=function(t){this._updateCount(t.name)},i.prototype.onSendMailSuccess=function(){this._updateCount("sent")},i.prototype._convert=function(t){return{id:t.id,unreadCount:this._getUnreadCount(t.emails)}},i.prototype._updateCount=function(t){var e;this.waitFor([o.dispatchToken]),e=o.getBox(t),this.boxData[t].unreadCount=this._getUnreadCount(e.emails)},i.prototype._getUnreadCount=function(t){return Object.keys(t).reduce(function(e,n){return t[n].isRead?e:e+1},0)},t.exports=a.createStore(i,"BoxStore")},234:function(t,e,n){"use strict";var i=n(1),a=n(153),s=n(218),r=n(235),o=i.createClass({displayName:"MailboxTab",propTypes:{name:i.PropTypes.string,unreadCount:i.PropTypes.number},mixins:[a.State,a.Navigation],_handleClick:function(){this.transitionTo("mailboxes",{name:this.props.name})},render:function(){var t=s({"list-group-item":!0,active:this.getParams().name===this.props.name});return i.createElement("li",{className:t,onClick:this._handleClick},i.createElement("span",{className:"badge"},this.props.unreadCount),r.formatBoxName(this.props.name))}});t.exports=o},235:function(t,e,n){"use strict";var i=n(236),a={inbox:"Inbox",spam:"Spam",sent:"Sent Mail"};t.exports={formatBoxName:function(t){return a[t]},formatDate:function(t){var e=i(t),n=i();return n.isSame(e,"day")?e.format("h:mm a"):n.isSame(e,"year")?e.format("MMM DD"):e.format("YYYY/MM/DD")},getUserName:function(){var t=JSON.parse(sessionStorage.getItem("user"));return t.name}}},322:function(t,e,n){"use strict";var i=n(1),a=n(153),s=a.RouteHandler,r=i.createClass({displayName:"Section",render:function(){return i.createElement("div",{className:"mailbox col-md-10"},i.createElement("div",{className:"panel panel-default"},i.createElement("div",{className:"panel-body"},i.createElement(s,null))))}});t.exports=r},323:function(t,e,n){"use strict";var i=n(1),a=n(324).DropdownButton,s=n(324).MenuItem,r=n(324).Navbar,o=n(324).NavItem,c=n(324).Nav,l=n(466),u=n(220),m=n(235),d=i.createClass({displayName:"Header",_handleLogOut:function(t){t.preventDefault(),l.logout(m.getUserName())},render:function(){return i.createElement(r,{brand:i.createElement("a",{href:"#"},u.TITLE),toggleNavKey:0,fixedTop:!0},i.createElement(c,{right:!0,eventKey:1},i.createElement(a,{title:m.getUserName()},i.createElement(s,{onClick:this._handleLogOut},"Sign out")),i.createElement(o,{href:"https://github.com/seanlin0800/rmail"},"About")))}});t.exports=d},466:function(t,e,n){"use strict";function i(){this.login=function(t){this.dispatch(),s.login(t)},this.logout=function(t){this.dispatch(),s.logout(t)}}var a=n(195),s=n(215);t.exports=a.createActions(i)},467:function(t,e,n){"use strict";function i(){this.bindActions(s),this.bindActions(r),this.user={name:"",authenticated:!1,isWaiting:!1,token:""},this.exportPublicMethods({isLoggedIn:function(){return!!sessionStorage.getItem("user")},isAuth:function(){return this.getState().user.authenticated},isWaiting:function(){return this.getState().user.isWaiting},getUser:function(){return this.getState().user}})}var a=n(195),s=n(466),r=n(216),o=n(468);i.prototype.onAuthSuccess=function(t){this.waitFor([o.dispatchToken]),this.user.name=t.name,this.user.authenticated=!0,this.user.isWaiting=!1},i.prototype.onLogin=function(){this.user.isWaiting=!0},i.prototype.onLoginSuccess=function(t){this.user.name=t.name,this.user.isWaiting=!1,this.user.authenticated=!0,sessionStorage.setItem("user",JSON.stringify(t))},i.prototype.onLoginError=function(){this.user.authenticated=!1,this.user.isWaiting=!1},i.prototype.onLogout=function(){this.user.authenticated=!1,this.user.isWaiting=!1,sessionStorage.removeItem("user")},t.exports=a.createStore(i,"UserStore")},468:function(t,e,n){"use strict";function i(){this.bindActions(s),this.authStatus={authenticated:!1,isWaiting:!1},this.exportPublicMethods({getStatus:function(){return this.getState().authStatus}})}var a=n(195),s=n(216);i.prototype.onAuth=function(){this.authStatus.isWaiting=!0},i.prototype.onAuthSuccess=function(){this.authStatus.isWaiting=!1,this.authStatus.authenticated=!0},i.prototype.onAuthError=function(){this.authStatus.authenticated=!1,this.authStatus.isWaiting=!1},t.exports=a.createStore(i,"AuthStore")},469:function(t,e,n){"use strict";var i=n(1),a=n(153),s=a.RouteHandler,r=n(211),o=n(470),c=n(468),l=n(472),u=n(220),m=i.createClass({displayName:"App",mixins:[r],getInitialState:function(){return{isLoading:!0}},componentDidMount:function(){this.listenTo(c,this._onChange)},_onChange:function(){c.getStatus().isWaiting||this.setState({isLoading:!1})},_renderHandler:function(){return this.state.isLoading?null:i.createElement(s,null)},render:function(){return i.createElement(o,{title:u.TITLE},i.createElement("div",{className:"main"},this._renderHandler(),i.createElement(l,null)))}});t.exports=m},472:function(t,e,n){"use strict";var i=n(1),a=n(211),s=n(473),r=n(474),o=i.createClass({displayName:"ProgressBar",mixins:[a],componentDidMount:function(){this.listenTo(r,this._onChange)},_onChange:function(){r.isLoading()?s.start():s.done()},render:function(){return i.createElement("div",null)}});t.exports=o},474:function(t,e,n){"use strict";function i(){this.bindListeners({startLoading:[s.SEND_MAIL,r.LOGIN],stopLoading:[o.SEND_MAIL_SUCCESS,o.LOGIN_SUCCESS,o.LOGIN_ERROR]}),this.loading=!1,this.exportPublicMethods({isLoading:function(){return this.getState().loading}})}var a=n(195),s=n(214),r=n(466),o=n(216);i.prototype.startLoading=function(){this.loading=!0},i.prototype.stopLoading=function(){this.loading=!1},t.exports=a.createStore(i,"ProgressBarStore")},475:function(t,e,n){"use strict";var i=n(1),a=n(153),s=n(211),r=n(466),o=n(467),c=n(220),l=i.createClass({displayName:"Login",mixins:[s,a.Navigation,a.State],statics:{willTransitionTo:function(t){o.isLoggedIn()&&t.redirect("main",{})}},getInitialState:function(){return{error:!1}},componentDidMount:function(){this.listenTo(o,this._onChange)},_onChange:function(){var t=this.getQuery().nextPath;o.isWaiting()||(o.isAuth()?t?this.replaceWith(t):this.replaceWith("main"):this.setState({error:!0}))},_handleLogIn:function(t){var e=i.findDOMNode(this.refs.email).value,n=i.findDOMNode(this.refs.password).value;t.preventDefault(),r.login({email:e,password:n})},_renderErrorMsg:function(){return this.state.error?i.createElement("span",{className:"text-danger"},"The email and password you entered don't match."):null},render:function(){return i.createElement("form",{className:"form-signin",onSubmit:this._handleLogIn},i.createElement("h3",{className:"form-signin-heading text-center"},"Sign in to continue to ",c.TITLE),i.createElement("label",{htmlFor:"inputEmail",className:"sr-only"},"Email address"),i.createElement("input",{type:"email",ref:"email",className:"form-control",placeholder:"Email address",autoFocus:!0}),i.createElement("label",{htmlFor:"inputPassword",className:"sr-only"},"Password"),i.createElement("input",{type:"password",ref:"password",className:"form-control",placeholder:"Password"}),i.createElement("button",{className:"btn btn-primary btn-block",type:"submit"},"Sign in"),i.createElement("p",null,"Hint: email: seanlin0800@rmail.com password: pass"),this._renderErrorMsg())}});t.exports=l},476:function(t,e,n){"use strict";var i=n(1),a=n(153),s=n(211),r=n(470),o=n(229),c=n(235),l=n(477),u=i.createClass({displayName:"Mailbox",mixins:[a.State,s],getInitialState:function(){return this._getStateFromStores(this.getParams().name)},componentDidMount:function(){this.listenTo(o,this._onChange)},componentWillReceiveProps:function(t){this.setState(this._getStateFromStores(t.params.name))},_getStateFromStores:function(t){var e=o.getBox(t);return{emails:e.emails}},_onChange:function(){this.setState(this._getStateFromStores(this.getParams().name))},render:function(){var t=this.getParams().name;return i.createElement(r,{title:c.formatBoxName(t)},i.createElement("div",null,i.createElement(l,{emails:this.state.emails,boxName:this.getParams().name})))}});t.exports=u},477:function(t,e,n){"use strict";var i=n(1),a=n(211),s=n(208),r=n(478),o=n(479),c=i.createClass({displayName:"EmailList",propTypes:{boxName:i.PropTypes.string,emails:i.PropTypes.object},mixins:[a],getInitialState:function(){return this._getStateFromStores()},componentDidMount:function(){this.listenTo(s,this._onChange)},_getStateFromStores:function(){return{isMenuActive:s.isMenuActive(),menuState:s.getMenuState()}},_renderContextMenu:function(){var t=null,e=this.props.emails;return this.state.isMenuActive&&(t=i.createElement(r,{boxName:this.props.boxName,status:this.state.menuState,mail:e[this.state.menuState.id]})),t},_onChange:function(){this.setState(this._getStateFromStores())},render:function(){var t=this.props.emails,e=Object.keys(t).sort(function(t,e){return e-t}),n=e.map(function(e){return i.createElement(o,{key:e,id:e,mail:t[e],boxName:this.props.boxName})}.bind(this));return i.createElement("table",{className:"email-list table"},i.createElement("tbody",null,n),this._renderContextMenu())}});t.exports=c},478:function(t,e,n){"use strict";var i=n(1),a=n(230),s=n(194),r=function(t){return function(e){e.stopPropagation(),e.preventDefault(),t(),s.hideMenu()}},o=i.createClass({displayName:"ContextMenu",propTypes:{boxName:i.PropTypes.string,status:i.PropTypes.object,mail:i.PropTypes.object},_markThread:function(){a.markThread(this.props.boxName,this.props.status.id,!this.props.mail.isRead)},_delete:function(){a["delete"](this.props.boxName,this.props.status.id)},render:function(){var t={left:this.props.status.xPos,top:this.props.status.yPos};return i.createElement("div",{className:"context-menu open",style:t},i.createElement("ul",{className:"dropdown-menu"},i.createElement("li",null,i.createElement("a",{href:"#",onClick:r(this._markThread)},"Mark as ",this.props.mail.isRead?"unread":"read")),i.createElement("li",null,i.createElement("a",{href:"#",onClick:r(this._delete)},i.createElement("span",{className:"glyphicon glyphicon-trash"})," Delete"))))}});t.exports=o},479:function(t,e,n){"use strict";var i=n(1),a=n(153),s=n(218),r=n(235),o=n(194),c=n(480),l=i.createClass({displayName:"EmailListItem",propTypes:{mail:i.PropTypes.object,id:i.PropTypes.string,boxName:i.PropTypes.string},mixins:[a.Navigation],_clickThread:function(){this.transitionTo("mails",{name:this.props.boxName,id:this.props.id})},_showContextMenu:function(t){t.preventDefault(),o.showMenu({xPos:t.clientX,yPos:t.clientY,id:this.props.id})},render:function(){var t=s({"mail-item":!0,active:this.props.mail.isRead}),e=s({unread:!this.props.mail.isRead,read:this.props.mail.isRead}),n=this.props.mail.isStarred?"Starred":"Not starred";return i.createElement("tr",{className:t,onClick:this._clickThread,onContextMenu:this._showContextMenu},i.createElement("td",{className:"bg"}),i.createElement("td",{className:"widget",title:n},i.createElement(c,{mail:this.props.mail,boxName:this.props.boxName})),i.createElement("td",{className:"from"},i.createElement("span",{className:e},this.props.mail.from)),i.createElement("td",null,i.createElement("span",{className:e},this.props.mail.subject)," - ",this.props.mail.body.substring(0,50)),i.createElement("td",null,i.createElement("span",{className:e},r.formatDate(this.props.mail.date))))}});t.exports=l},480:function(t,e,n){"use strict";var i=n(1),a=n(218),s=n(230),r=i.createClass({displayName:"StarWidget",propTypes:{mail:i.PropTypes.object,boxName:i.PropTypes.string},_clickHandler:function(t){t.stopPropagation(),s.clickStar({name:this.props.boxName,id:this.props.mail.id,val:this.props.mail.isStarred})},render:function(){var t=a({star:!0,"star-lit":this.props.mail.isStarred,"star-normal":!this.props.mail.isStarred});return i.createElement("div",{className:t,onClick:this._clickHandler}," ")}});t.exports=r},481:function(t,e,n){"use strict";var i=n(1),a=n(153),s=n(211),r=n(470),o=n(235),c=n(230),l=n(229),u=n(480),m=i.createClass({displayName:"Email",propTypes:{mail:i.PropTypes.object},mixins:[a.State,s],getInitialState:function(){var t=this.getParams().id,e=this.getParams().name;return this._getStateFromStores(e,t)},componentDidMount:function(){this.listenTo(l,this._onChange),this._markRead()},componentWillReceiveProps:function(t){var e=t.params.id,n=t.params.name;this.setState(this._getStateFromStores(n,e))},componentDidUpdate:function(){this._markRead()},_getStateFromStores:function(t,e){return{mail:l.get(t,e)}},_markRead:function(){this.state.mail&&!this.state.mail.isRead&&c.markThread(this.getParams().name,this.getParams().id,!0)},_onChange:function(){this.setState(this._getStateFromStores(this.getParams().name,this.getParams().id))},render:function(){var t=this.state.mail;return t?i.createElement(r,{title:this.state.mail.subject},i.createElement("div",null,i.createElement("h2",null,t.subject),i.createElement("div",{className:"email"},i.createElement("div",{className:"row"},i.createElement("div",{className:"col-md-10"},t.from),i.createElement("div",{className:"col-md-2"},i.createElement(u,{mail:this.state.mail,boxName:this.getParams().name}),o.formatDate(t.date))),i.createElement("div",{className:"to"},"to ",t.to)),i.createElement("div",{className:"body",dangerouslySetInnerHTML:{__html:t.body}}))):null}});t.exports=m},482:function(t,e,n){"use strict";var i=n(1),a={create:function(t){return i.createClass({render:function(){return i.createElement("div",{className:"none-selected alert alert-warning",role:"alert"},i.createElement("span",null,"No ",t," selected."))}})}};t.exports=a},483:function(t,e){"use strict";t.exports={init:function(){sessionStorage.mails||sessionStorage.setItem("mails",JSON.stringify([{id:1,name:"inbox",emails:[{id:1,from:"alice@rmail.com",to:"seanlin0800@rmail.com",subject:"Greeting",body:"Just wanna say hi.",isRead:!1,isStarred:!1,date:"2014-12-29T04:44:44Z"},{id:2,from:"react@facebook.com",to:"seanlin0800@rmail.com",subject:"News Digest",body:'<h1>Awesome React</h1> <img src="https://raw.githubusercontent.com/wiki/facebook/react/react-logo-1000-transparent.png" width=300/)>',isRead:!1,isStarred:!1,date:"2015-04-25T04:44:44Z"},{id:3,from:"admin@github.com",to:"seanlin0800@rmail.com",subject:"Welcome to Github",body:"Welcome!! Thanks for signing up with Github.",isRead:!1,isStarred:!1,date:(new Date).toISOString()}]},{id:2,name:"spam",emails:[{id:3,from:"richdad@gmail.com",to:"seanlin0800@rmail.com",subject:"Want to Be Rich?",body:"Have you ever dreamed of being a millionaire? Here're some secrets rich people don't want you to know.",isRead:!1,isStarred:!1,date:"2015-07-04T16:44:44Z"}]},{id:3,name:"sent",emails:[]}]))}}},484:function(t,e){},493:function(t,e){},495:function(t,e){}});